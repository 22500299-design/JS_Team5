<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>main2 - ê¸°ë³¸ ì¹´ë“œ í•™ìŠµ & ì‚¬ì§€ì„ ë‹¤</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Noto+Sans+KR:wght@300;500;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0f172a;
      --card:#111827;
      --accent:#38bdf8;
      --accent2:#0ea5e9;
      --text:#e5e7eb;
      --muted:#9ca3af;
      --border:rgba(55,65,81,0.9);
      --shadow:0 18px 40px rgba(15,23,42,0.9);
      --r-lg:18px;
      --r-xl:22px;
      --t:0.2s ease;
    }
    *{box-sizing:border-box;}
    body{
      margin:0; min-height:100vh;
      font-family:"Noto Sans KR","Poppins",system-ui,sans-serif;
      background: radial-gradient(circle at top, #1f2933, #020617 55%);
      color:var(--text);
      display:flex; justify-content:center; align-items:stretch;
    }
    .app{
      width:min(1100px,100%);
      margin:20px;
      border-radius:24px;
      background: linear-gradient(145deg, rgba(15,23,42,0.98), rgba(15,23,42,0.9));
      border:1px solid rgba(148,163,184,0.18);
      box-shadow:var(--shadow);
      overflow:hidden;
      display:flex; flex-direction:column;
    }
    header{
      padding:18px 24px 14px;
      border-bottom:1px solid rgba(55,65,81,0.7);
      display:flex; justify-content:space-between; align-items:center;
      background: radial-gradient(circle at top left, rgba(56,189,248,0.08), transparent 50%);
      backdrop-filter: blur(14px);
    }
    header h1{
      margin:0;
      font-size:20px; font-weight:700;
      display:flex; gap:8px; align-items:center;
    }
    .logo-dot{
      width:10px; height:10px; border-radius:999px;
      background: radial-gradient(circle at 30% 30%, #e5f9ff, var(--accent2));
      box-shadow:0 0 12px rgba(56,189,248,0.9);
    }
    header p{margin:4px 0 0; font-size:12px; color:var(--muted);}
    .title-block{display:flex; flex-direction:column;}
    .header-actions{display:flex; gap:8px; align-items:center;}

    button{
      font-family:inherit; cursor:pointer;
      border-radius:999px;
      border:1px solid transparent;
      padding:6px 14px;
      font-size:13px;
      background: rgba(15,23,42,0.9);
      color: var(--text);
      transition: transform var(--t), box-shadow var(--t), background var(--t), border-color var(--t), color var(--t), opacity var(--t);
    }
    button.primary{
      background: linear-gradient(to right, var(--accent), var(--accent2));
      color:#0b1120; font-weight:600;
      box-shadow:0 10px 25px rgba(56,189,248,0.45);
    }
    button.primary:hover{transform:translateY(-1px); box-shadow:0 16px 40px rgba(56,189,248,0.6);}
    button.secondary{
      border-color: rgba(148,163,184,0.5);
      background: rgba(15,23,42,0.85);
      color: var(--muted);
    }
    button.secondary:hover{border-color:var(--accent); color:var(--accent2);}
    button.small{padding:4px 10px; font-size:11px;}
    button[disabled]{opacity:.4; cursor:default;}

    main{
      padding:18px 22px 14px;
      display:flex; flex-direction:column; gap:14px;
      flex:1;
    }

    .view-switch{
      display:flex; gap:8px;
      padding:6px;
      border-radius:999px;
      background: rgba(15,23,42,0.9);
      border:1px solid rgba(55,65,81,0.9);
      align-self:flex-start;
    }
    .chip{
      border-radius:999px;
      padding:6px 14px;
      font-size:12px;
      border:1px solid transparent;
      background:transparent;
      color:var(--muted);
    }
    .chip.active{
      background: rgba(15,23,42,0.96);
      border-color: var(--accent);
      color: var(--accent2);
    }
    .panel{
      border-radius: var(--r-xl);
      background: radial-gradient(circle at top left, rgba(15,23,42,1), rgba(15,23,42,0.98));
      border: 1px solid var(--border);
      padding: 16px 16px 14px;
      box-shadow: 0 16px 40px rgba(15,23,42,0.9);
      display:flex; flex-direction:column; gap:12px;
    }
    .panel-header{
      display:flex; justify-content:space-between; align-items:center; gap:10px;
    }
    .panel-header h2{margin:0; font-size:15px;}
    .hint{font-size:12px; color:var(--muted);}

    .deck-grid{
      display:grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap:12px;
      margin-top:6px;
    }
    .deck-card{
      border-radius: var(--r-lg);
      border:1px solid var(--border);
      background: radial-gradient(circle at top left, rgba(15,23,42,1), rgba(15,23,42,0.96));
      padding:14px;
      cursor:pointer;
      transition: transform var(--t), box-shadow var(--t), border-color var(--t);
      box-shadow:0 10px 30px rgba(15,23,42,0.95);
      position:relative;
      min-height:90px;
    }
    .deck-card:hover{
      transform: translateY(-3px);
      border-color: rgba(148,163,184,0.7);
      box-shadow:0 18px 36px rgba(15,23,42,1);
    }
    .deck-title{font-weight:700; font-size:14px;}
    .deck-sub{margin-top:6px; font-size:12px; color:var(--muted);}

    .cards-container{
      display:grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap:10px;
      padding-top:6px;
      max-height:360px;
      overflow:auto;
      padding-right:4px;
    }
    .card{
      border-radius: var(--r-lg);
      border:1px solid var(--border);
      background: radial-gradient(circle at top left, rgba(15,23,42,1), rgba(15,23,42,0.96));
      padding:10px 10px 12px;
      cursor:pointer;
      transition: transform var(--t), box-shadow var(--t), border-color var(--t), background var(--t);
      min-height:90px;
      display:flex; flex-direction:column; justify-content:space-between;
      user-select:none;
    }
    .card:hover{transform:translateY(-3px); border-color:rgba(148,163,184,0.6);}
    .card.flipped{
      background: radial-gradient(circle at bottom right, rgba(8,47,73,1), rgba(15,23,42,1));
      border-color: var(--accent2);
    }
    .card-label{
      font-size:11px;
      color: rgba(148,163,184,0.9);
      letter-spacing:0.1em;
      text-transform:uppercase;
    }
    .card-text{margin-top:6px; font-size:13px;}
    .card-bottom{margin-top:10px; font-size:10px; color:var(--muted); display:flex; justify-content:space-between;}

    .test-area{
      border-radius: var(--r-xl);
      border:1px solid var(--border);
      background: radial-gradient(circle at bottom right, rgba(15,23,42,1), rgba(15,23,42,0.98));
      padding:18px 16px;
      box-shadow:0 16px 40px rgba(15,23,42,0.95);
      display:flex; flex-direction:column; gap:12px;
    }
    .question-header{display:flex; justify-content:space-between; font-size:12px; color:var(--muted);}
    .question-main{
      border-radius:18px;
      padding:16px 14px;
      border:1px solid var(--border);
      background: radial-gradient(circle at top, rgba(15,23,42,1), rgba(15,23,42,0.98));
      text-align:center;
      font-size:18px; font-weight:700;
      min-height:64px;
      display:flex; align-items:center; justify-content:center;
    }
    .options-grid{
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap:8px;
      margin-top:6px;
    }
    .option-btn{
      border-radius: var(--r-lg);
      padding:10px 10px;
      border:1px solid var(--border);
      background: rgba(15,23,42,0.96);
      font-size:13px;
      text-align:left;
    }
    .option-btn:hover{border-color:var(--accent2); transform:translateY(-2px); box-shadow:0 12px 26px rgba(15,23,42,1);}
    .hidden{display:none !important;}

    .row{
      display:flex; gap:8px; align-items:center; justify-content:space-between;
      flex-wrap:wrap;
    }
    .pill{
      border-radius:999px;
      padding:4px 10px;
      background: rgba(15,23,42,0.9);
      border:1px solid rgba(148,163,184,0.5);
      font-size:11px;
      color:var(--muted);
    }

    @media (max-width: 640px){
      .options-grid{grid-template-columns: 1fr;}
    }
  </style>
</head>

<body>
  <div class="app">
    <header>
      <div class="title-block">
        <h1><span class="logo-dot"></span>ê¸°ë³¸ ì¹´ë“œ í•™ìŠµ & ì‚¬ì§€ì„ ë‹¤</h1>
        <p id="subTitle">ë±ì„ ì„ íƒí•˜ê³  í•™ìŠµ/í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•œë‹¤.</p>
      </div>
      <div class="header-actions">
        <button class="secondary small" onclick="location.href='choice.html'">â† choice</button>
        <button class="secondary small" onclick="location.href='main1.html'">main1(ì¹´ë“œ ë§Œë“¤ê¸°)</button>
      </div>
    </header>

    <main>
      <div class="view-switch">
        <button id="chipDeck" class="chip active">ë± ì„ íƒ</button>
        <button id="chipLearn" class="chip">í•™ìŠµ</button>
        <button id="chipTest" class="chip">í…ŒìŠ¤íŠ¸(ì‚¬ì§€ì„ ë‹¤)</button>
      </div>

      <!-- ë± ì„ íƒ -->
      <section id="viewDeck" class="panel">
        <div class="panel-header">
          <h2>ì–´ë–¤ ê±¸ í• ë˜?</h2>
          <span class="pill">ì¹´ë“œ í˜•íƒœ ì„ íƒ</span>
        </div>
        <div class="hint">ì˜ì–´ / ì¼ë³¸ì–´ / ìë°”ìŠ¤í¬ë¦½íŠ¸ í€´ì¦ˆ ì¤‘ í•˜ë‚˜ë¥¼ ê³ ë¥¸ë‹¤.</div>

        <div class="deck-grid">
          <div class="deck-card" id="deckEnglish">
            <div class="deck-title">ğŸ‡ºğŸ‡¸ ì˜ì–´ ë‹¨ì–´</div>
            <div class="deck-sub">25ê°œ ê¸°ë³¸ ë‹¨ì–´ë¡œ í•™ìŠµ/í…ŒìŠ¤íŠ¸</div>
          </div>

          <div class="deck-card" id="deckJapanese">
            <div class="deck-title">ğŸ‡¯ğŸ‡µ ì¼ë³¸ì–´ ê¸°ì´ˆ</div>
            <div class="deck-sub">25ê°œ ê¸°ë³¸ ë‹¨ì–´ë¡œ í•™ìŠµ/í…ŒìŠ¤íŠ¸</div>
          </div>

          <div class="deck-card" id="deckJS">
            <div class="deck-title">ğŸ’» JS í€´ì¦ˆ</div>
            <div class="deck-sub">ì´ˆê¸‰ 25ë¬¸ì œë¡œ ì‚¬ì§€ì„ ë‹¤ í…ŒìŠ¤íŠ¸</div>
          </div>
        </div>
      </section>

      <!-- í•™ìŠµ -->
      <section id="viewLearn" class="panel hidden">
        <div class="panel-header">
          <div>
            <h2 id="learnTitle">í•™ìŠµí•˜ê¸°</h2>
            <div class="hint">ì¹´ë“œë¥¼ í´ë¦­í•˜ë©´ ë’¤ì§‘íŒë‹¤. (ë‹¤ì‹œ í´ë¦­í•˜ë©´ ë³µê·€)</div>
          </div>
          <div class="row">
            <span id="deckInfo" class="pill">ì„ íƒëœ ë±: -</span>
            <button class="primary small" id="btnGoTest">í…ŒìŠ¤íŠ¸ ì‹œì‘</button>
          </div>
        </div>

        <div id="cardsContainer" class="cards-container"></div>
        <div id="learnEmpty" class="hint">ë±ì„ ë¨¼ì € ì„ íƒí•´ì¤˜.</div>
      </section>

      <!-- í…ŒìŠ¤íŠ¸(ì‚¬ì§€ì„ ë‹¤) -->
      <section id="viewTest" class="test-area hidden">
        <div class="row">
          <div class="hint" id="testHint">ë³´ê¸° 4ê°œ ì¤‘ ì •ë‹µì„ 1ë²ˆ í´ë¦­í•œë‹¤.</div>
          <div class="row">
            <button class="secondary small" id="btnRestart">ë‹¤ì‹œ ì‹œì‘</button>
            <button class="secondary small" id="btnBackLearn">í•™ìŠµìœ¼ë¡œ</button>
          </div>
        </div>

        <div class="question-header">
          <span id="testTypeLabel">ì‹œí—˜ ìœ í˜•: ì‚¬ì§€ì„ ë‹¤</span>
          <span id="questionCounter">0 / 0</span>
        </div>

        <div id="questionText" class="question-main">ë¬¸ì œê°€ ì—¬ê¸°ì— í‘œì‹œëœë‹¤</div>
        <div id="mcOptions" class="options-grid"></div>

        <div class="hint" id="resultHint"></div>
      </section>
    </main>
  </div>

  <script>
    // =========================================================
    // âœ… ì—¬ê¸° ì•ˆì— ë± ë°ì´í„° ì „ë¶€ í¬í•¨ (decks.js í•„ìš” ì—†ìŒ)
    // =========================================================
    var DECKS = {
      english: {
        title: "ì˜ì–´ ë‹¨ì–´ 25",
        cards: [
          {front:"acknowledge", back:"ì¸ì •í•˜ë‹¤, ìŠ¹ì¸í•˜ë‹¤"},
          {front:"analyze", back:"ë¶„ì„í•˜ë‹¤"},
          {front:"approach", back:"ì ‘ê·¼í•˜ë‹¤, ë°©ë²•"},
          {front:"assess", back:"í‰ê°€í•˜ë‹¤"},
          {front:"assume", back:"ê°€ì •í•˜ë‹¤"},
          {front:"authority", back:"ê¶Œìœ„, ê¶Œí•œ"},
          {front:"benefit", back:"ì´ìµ, í˜œíƒ"},
          {front:"concept", back:"ê°œë…"},
          {front:"consistent", back:"ì¼ê´€ëœ"},
          {front:"context", back:"ë§¥ë½, ë¬¸ë§¥"},
          {front:"demonstrate", back:"ì…ì¦í•˜ë‹¤, ë³´ì—¬ì£¼ë‹¤"},
          {front:"derive", back:"ìœ ë˜í•˜ë‹¤, ëŒì–´ë‚´ë‹¤"},
          {front:"distribute", back:"ë¶„ë°°í•˜ë‹¤"},
          {front:"establish", back:"í™•ë¦½í•˜ë‹¤, ì„¤ë¦½í•˜ë‹¤"},
          {front:"evaluate", back:"í‰ê°€í•˜ë‹¤"},
          {front:"evident", back:"ëª…ë°±í•œ"},
          {front:"framework", back:"í‹€, êµ¬ì¡°"},
          {front:"illustrate", back:"ì„¤ëª…í•˜ë‹¤, ì˜ˆì‹œë¥¼ ë“¤ë‹¤"},
          {front:"interpret", back:"í•´ì„í•˜ë‹¤"},
          {front:"maintain", back:"ìœ ì§€í•˜ë‹¤"},
          {front:"obtain", back:"ì–»ë‹¤, íšë“í•˜ë‹¤"},
          {front:"participate", back:"ì°¸ì—¬í•˜ë‹¤"},
          {front:"perceive", back:"ì¸ì‹í•˜ë‹¤"},
          {front:"require", back:"ìš”êµ¬í•˜ë‹¤"},
          {front:"significant", back:"ì¤‘ìš”í•œ, ì˜ë¯¸ ìˆëŠ”"}
        ]
      },
      japanese: {
        title: "ì¼ë³¸ì–´ ê¸°ì´ˆ 25",
        cards: [
          {front:"å¤§å­¦(ã ã„ãŒã)", back:"ëŒ€í•™"},
          {front:"å‹‰å¼·(ã¹ã‚“ãã‚‡ã†)", back:"ê³µë¶€"},
          {front:"è©¦é¨“(ã—ã‘ã‚“)", back:"ì‹œí—˜"},
          {front:"æˆæ¥­(ã˜ã‚…ãã‚‡ã†)", back:"ìˆ˜ì—…"},
          {front:"å›³æ›¸é¤¨(ã¨ã—ã‚‡ã‹ã‚“)", back:"ë„ì„œê´€"},
          {front:"å­¦ç”Ÿ(ãŒãã›ã„)", back:"í•™ìƒ"},
          {front:"æ•™ç§‘æ›¸(ãã‚‡ã†ã‹ã—ã‚‡)", back:"êµê³¼ì„œ"},
          {front:"å®¿é¡Œ(ã—ã‚…ãã ã„)", back:"ìˆ™ì œ"},
          {front:"å’æ¥­(ãã¤ãã‚‡ã†)", back:"ì¡¸ì—…"},
          {front:"å°‚æ”»(ã›ã‚“ã“ã†)", back:"ì „ê³µ"},
          {front:"è¬›ç¾©(ã“ã†ã)", back:"ê°•ì˜"},
          {front:"ç ”ç©¶(ã‘ã‚“ãã‚…ã†)", back:"ì—°êµ¬"},
          {front:"ç™ºè¡¨(ã¯ã£ã´ã‚‡ã†)", back:"ë°œí‘œ"},
          {front:"èª²é¡Œ(ã‹ã ã„)", back:"ê³¼ì œ"},
          {front:"æˆç¸¾(ã›ã„ã›ã)", back:"ì„±ì "},
          {front:"å˜ä½(ãŸã‚“ã„)", back:"í•™ì "},
          {front:"å¥¨å­¦é‡‘(ã—ã‚‡ã†ãŒããã‚“)", back:"ì¥í•™ê¸ˆ"},
          {front:"é£Ÿå ‚(ã—ã‚‡ãã©ã†)", back:"ì‹ë‹¹"},
          {front:"å¯®(ã‚Šã‚‡ã†)", back:"ê¸°ìˆ™ì‚¬"},
          {front:"å‹é”(ã¨ã‚‚ã ã¡)", back:"ì¹œêµ¬"},
          {front:"å…ˆç”Ÿ(ã›ã‚“ã›ã„)", back:"ì„ ìƒë‹˜"},
          {front:"è³ªå•(ã—ã¤ã‚‚ã‚“)", back:"ì§ˆë¬¸"},
          {front:"ç­”ãˆ(ã“ãŸãˆ)", back:"ë‹µ"},
          {front:"ç†è§£(ã‚Šã‹ã„)", back:"ì´í•´"},
          {front:"å¾©ç¿’(ãµãã—ã‚…ã†)", back:"ë³µìŠµ"}
        ]
      },
      jsquiz: {
        title: "JS í€´ì¦ˆ(ì´ˆê¸‰) 25",
        cards: [
          {front:"Q1. ë³€ìˆ˜ëŠ” ë¬´ì—‡ì¸ê°€ìš”?", back:"A. ê°’ì„ ì €ì¥í•˜ëŠ” ìƒì(ì €ì¥ ê³µê°„)"},
          {front:"Q2. letì€ ì–´ë–¤ ìŠ¤ì½”í”„ì¸ê°€ìš”?", back:"A. ë¸”ë¡ ìŠ¤ì½”í”„"},
          {front:"Q3. constëŠ” ë¬´ì—‡ì„ ë§‰ë‚˜ìš”?", back:"A. ì¬í• ë‹¹ì„ ë§‰ëŠ”ë‹¤"},
          {front:"Q4. ë¬¸ìì—´ì€ ë”°ì˜´í‘œë¡œ ê°ì‹¸ë‚˜ìš”?", back:"A. ë„¤ (' ' ë˜ëŠ” \" \")"},
          {front:"Q5. ìˆ«ì 2ê°œ ë”í•˜ê¸°ëŠ” ì–´ë–¤ ì—°ì‚°ì?", back:"A. +"},
          {front:"Q6. console.logëŠ” ì–´ë””ì— ì¶œë ¥?", back:"A. ì½˜ì†”(ê°œë°œì ë„êµ¬)"},
          {front:"Q7. ifëŠ” ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?", back:"A. ì¡°ê±´ì´ trueì¼ ë•Œ"},
          {front:"Q8. elseëŠ” ì–¸ì œ ì‹¤í–‰ë˜ë‚˜ìš”?", back:"A. ì¡°ê±´ì´ falseì¼ ë•Œ"},
          {front:"Q9. ë¹„êµí•  ë•Œ ê°™ë‹¤(ì—„ê²©)ëŠ”?", back:"A. ==="},
          {front:"Q10. ê°™ë‹¤(ëŠìŠ¨)ëŠ”?", back:"A. =="},
          {front:"Q11. ë°°ì—´ì€ ë¬´ì—‡ì¸ê°€ìš”?", back:"A. ì—¬ëŸ¬ ê°’ì„ ì €ì¥í•˜ëŠ” ë¦¬ìŠ¤íŠ¸"},
          {front:"Q12. ë°°ì—´ ì²« ë²ˆì§¸ ì¸ë±ìŠ¤ëŠ”?", back:"A. 0"},
          {front:"Q13. lengthëŠ” ë¬´ì—‡?", back:"A. ë°°ì—´(ë¬¸ìì—´) ê¸¸ì´"},
          {front:"Q14. í•¨ìˆ˜ë€?", back:"A. ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì½”ë“œ ë¬¶ìŒ"},
          {front:"Q15. í•¨ìˆ˜ í˜¸ì¶œì€ ì–´ë–»ê²Œ?", back:"A. í•¨ìˆ˜ì´ë¦„()"},
          {front:"Q16. forë¬¸ì€ ë¬´ì—‡?", back:"A. ë°˜ë³µ ì‹¤í–‰"},
          {front:"Q17. whileë¬¸ì€ ë¬´ì—‡?", back:"A. ì¡°ê±´ì´ trueì¸ ë™ì•ˆ ë°˜ë³µ"},
          {front:"Q18. breakëŠ” ë¬´ì—‡?", back:"A. ë°˜ë³µë¬¸ ì¦‰ì‹œ ì¢…ë£Œ"},
          {front:"Q19. continueëŠ” ë¬´ì—‡?", back:"A. ì´ë²ˆ ë°˜ë³µë§Œ ê±´ë„ˆëœ€"},
          {front:"Q20. promptëŠ” ë¬´ì—‡?", back:"A. ì‚¬ìš©ìì—ê²Œ ì…ë ¥ ë°›ê¸°"},
          {front:"Q21. alertëŠ” ë¬´ì—‡?", back:"A. ê²½ê³ ì°½ ë„ìš°ê¸°"},
          {front:"Q22. document.getElementByIdëŠ”?", back:"A. idë¡œ ìš”ì†Œ ì°¾ê¸°"},
          {front:"Q23. addEventListenerëŠ”?", back:"A. ì´ë²¤íŠ¸(í´ë¦­ ë“±) ì—°ê²°"},
          {front:"Q24. Math.randomì€?", back:"A. 0~1 ì‚¬ì´ ëœë¤ ìˆ«ì"},
          {front:"Q25. ë¬¸ìì—´ í•©ì¹˜ê¸°ëŠ”?", back:"A. + ë˜ëŠ” í…œí”Œë¦¿ ë¦¬í„°ëŸ´"}
        ]
      }
    };

    // =========================
    // ìƒíƒœ
    // =========================
    var currentDeckKey = null;
    var currentCards = [];
    var flipState = {}; // index -> true/false

    // í…ŒìŠ¤íŠ¸ ìƒíƒœ
    var qList = [];      // [{idx, promptSide}]
    var qIndex = 0;
    var correctAnswer = "";
    var score = 0;

    // =========================
    // DOM
    // =========================
    var chipDeck = document.getElementById("chipDeck");
    var chipLearn = document.getElementById("chipLearn");
    var chipTest = document.getElementById("chipTest");

    var viewDeck = document.getElementById("viewDeck");
    var viewLearn = document.getElementById("viewLearn");
    var viewTest = document.getElementById("viewTest");

    var learnTitle = document.getElementById("learnTitle");
    var deckInfo = document.getElementById("deckInfo");
    var cardsContainer = document.getElementById("cardsContainer");
    var learnEmpty = document.getElementById("learnEmpty");
    var btnGoTest = document.getElementById("btnGoTest");

    var questionCounter = document.getElementById("questionCounter");
    var questionText = document.getElementById("questionText");
    var mcOptions = document.getElementById("mcOptions");
    var resultHint = document.getElementById("resultHint");

    var btnRestart = document.getElementById("btnRestart");
    var btnBackLearn = document.getElementById("btnBackLearn");

    // ë± ì„ íƒ ì¹´ë“œ
    var deckEnglish = document.getElementById("deckEnglish");
    var deckJapanese = document.getElementById("deckJapanese");
    var deckJS = document.getElementById("deckJS");

    // =========================
    // ìœ í‹¸
    // =========================
    function shuffle(arr){
      for(var i=arr.length-1;i>0;i--){
        var j=Math.floor(Math.random()*(i+1));
        var t=arr[i]; arr[i]=arr[j]; arr[j]=t;
      }
    }

    function setActiveChip(active){
      chipDeck.classList.remove("active");
      chipLearn.classList.remove("active");
      chipTest.classList.remove("active");
      if(active==="deck") chipDeck.classList.add("active");
      if(active==="learn") chipLearn.classList.add("active");
      if(active==="test") chipTest.classList.add("active");
    }

    function showView(name){
      viewDeck.classList.add("hidden");
      viewLearn.classList.add("hidden");
      viewTest.classList.add("hidden");

      if(name==="deck"){ viewDeck.classList.remove("hidden"); setActiveChip("deck"); }
      if(name==="learn"){ viewLearn.classList.remove("hidden"); setActiveChip("learn"); }
      if(name==="test"){ viewTest.classList.remove("hidden"); setActiveChip("test"); }
    }

    // =========================
    // ë± ì„ íƒ
    // =========================
    function selectDeck(key){
      currentDeckKey = key;
      currentCards = DECKS[key].cards.slice();
      flipState = {};

      deckInfo.textContent = "ì„ íƒëœ ë±: " + DECKS[key].title;
      learnTitle.textContent = "í•™ìŠµí•˜ê¸° - " + DECKS[key].title;

      renderLearnCards();
      showView("learn");
    }

    // =========================
    // í•™ìŠµ ì¹´ë“œ ë Œë”
    // =========================
    function renderLearnCards(){
      cardsContainer.innerHTML = "";

      if(!currentDeckKey){
        learnEmpty.style.display="block";
        return;
      }

      learnEmpty.style.display="none";

      for(var i=0;i<currentCards.length;i++){
        (function(idx){
          var card = currentCards[idx];

          var div = document.createElement("div");
          div.className = "card";

          var label = document.createElement("div");
          label.className = "card-label";
          label.textContent = "ì•ë©´";

          var text = document.createElement("div");
          text.className = "card-text";
          text.textContent = card.front;

          var bottom = document.createElement("div");
          bottom.className = "card-bottom";
          bottom.innerHTML = "<span>#"+(idx+1)+"</span><span>í´ë¦­í•´ì„œ ë’¤ì§‘ê¸°</span>";

          div.addEventListener("click", function(){
            var flipped = !!flipState[idx];
            flipped = !flipped;
            flipState[idx] = flipped;

            if(flipped){
              div.classList.add("flipped");
              label.textContent = "ë’·ë©´";
              text.textContent = card.back;
            }else{
              div.classList.remove("flipped");
              label.textContent = "ì•ë©´";
              text.textContent = card.front;
            }
          });

          div.appendChild(label);
          div.appendChild(text);
          div.appendChild(bottom);
          cardsContainer.appendChild(div);
        })(i);
      }
    }

    // =========================
    // í…ŒìŠ¤íŠ¸(ì‚¬ì§€ì„ ë‹¤)
    // =========================
    function buildQuestions(){
      qList = [];
      for(var i=0;i<currentCards.length;i++){
        qList.push({idx:i, promptSide:"front"});
      }
      shuffle(qList);
    }

    function startTest(){
      if(!currentDeckKey){
        alert("ë±ì„ ë¨¼ì € ì„ íƒí•´ì•¼ í•œë‹¤.");
        showView("deck");
        return;
      }
      score = 0;
      qIndex = 0;
      resultHint.textContent = "";

      buildQuestions();
      showView("test");
      renderQuestion();
    }

    function renderQuestion(){
      if(qIndex >= qList.length){
        questionText.textContent = "ë! ì ìˆ˜: " + score + " / " + qList.length;
        mcOptions.innerHTML = "";
        questionCounter.textContent = qList.length + " / " + qList.length;
        resultHint.textContent = "ë‹¤ì‹œ í•˜ë ¤ë©´ 'ë‹¤ì‹œ ì‹œì‘'ì„ ëˆŒëŸ¬ì¤˜.";
        return;
      }

      var q = qList[qIndex];
      var card = currentCards[q.idx];

      var prompt = card.front;
      var answer = card.back;
      correctAnswer = answer;

      questionCounter.textContent = (qIndex+1) + " / " + qList.length;
      questionText.textContent = prompt;

      renderOptions(answer, q.idx);
    }

    function renderOptions(answer, correctIdx){
      mcOptions.innerHTML = "";

      var pool = [];
      for(var i=0;i<currentCards.length;i++){
        if(i !== correctIdx) pool.push(currentCards[i].back);
      }
      shuffle(pool);

      var options = [answer];
      for(var k=0;k<pool.length && options.length<4;k++){
        if(pool[k] && pool[k] !== answer) options.push(pool[k]);
      }
      while(options.length<4) options.push(answer);
      shuffle(options);

      for(var j=0;j<options.length;j++){
        (function(text){
          var btn = document.createElement("button");
          btn.className = "option-btn";
          btn.type = "button";
          btn.textContent = text;
          btn.addEventListener("click", function(){
            handleChoice(text);
          });
          mcOptions.appendChild(btn);
        })(options[j]);
      }
    }

    function handleChoice(selected){
      if(selected === correctAnswer){
        score++;
        resultHint.textContent = "âœ… ì •ë‹µ!";
      }else{
        resultHint.textContent = "âŒ ì˜¤ë‹µ! ì •ë‹µ: " + correctAnswer;
      }
      qIndex++;
      setTimeout(function(){
        resultHint.textContent = "";
        renderQuestion();
      }, 300);
    }

    // =========================
    // ì´ë²¤íŠ¸ ì—°ê²° (âœ… ì—¬ê¸° ë¹ ì§€ë©´ í´ë¦­ ì•ˆ ë¨)
    // =========================
    deckEnglish.addEventListener("click", function(){ selectDeck("english"); });
    deckJapanese.addEventListener("click", function(){ selectDeck("japanese"); });
    deckJS.addEventListener("click", function(){ selectDeck("jsquiz"); });

    chipDeck.addEventListener("click", function(){ showView("deck"); });
    chipLearn.addEventListener("click", function(){
      if(!currentDeckKey){ alert("ë±ì„ ë¨¼ì € ì„ íƒí•´ì¤˜."); showView("deck"); return; }
      showView("learn");
    });
    chipTest.addEventListener("click", function(){
      if(!currentDeckKey){ alert("ë±ì„ ë¨¼ì € ì„ íƒí•´ì¤˜."); showView("deck"); return; }
      startTest();
    });

    btnGoTest.addEventListener("click", startTest);
    btnRestart.addEventListener("click", startTest);
    btnBackLearn.addEventListener("click", function(){ showView("learn"); });

    // ì´ˆê¸° í™”ë©´
    showView("deck");
  </script>
</body>
</html>
